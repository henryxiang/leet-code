{
  "questionId": "601",
  "questionFrontendId": "601",
  "boundTopicId": null,
  "title": "Human Traffic of Stadium",
  "titleSlug": "human-traffic-of-stadium",
  "categoryTitle": "Database",
  "content": "<p>X city built a new stadium, each day many people visit it and the stats are saved as these columns: <b>id</b>, <strong>visit_</strong><b>date</b>, <b>people</b></p>\r\n\r\n<p>Please write a query to display the records which have 3 or more consecutive rows and the amount of people more than 100(inclusive).</p>\r\nFor example, the table <code>stadium</code>:\r\n\r\n<pre>\r\n+------+------------+-----------+\r\n| id   | visit_date | people    |\r\n+------+------------+-----------+\r\n| 1    | 2017-01-01 | 10        |\r\n| 2    | 2017-01-02 | 109       |\r\n| 3    | 2017-01-03 | 150       |\r\n| 4    | 2017-01-04 | 99        |\r\n| 5    | 2017-01-05 | 145       |\r\n| 6    | 2017-01-06 | 1455      |\r\n| 7    | 2017-01-07 | 199       |\r\n| 8    | 2017-01-08 | 188       |\r\n+------+------------+-----------+\r\n</pre>\r\n\r\n<p>For the sample data above, the output is:</p>\r\n\r\n<pre>\r\n+------+------------+-----------+\r\n| id   | visit_date | people    |\r\n+------+------------+-----------+\r\n| 5    | 2017-01-05 | 145       |\r\n| 6    | 2017-01-06 | 1455      |\r\n| 7    | 2017-01-07 | 199       |\r\n| 8    | 2017-01-08 | 188       |\r\n+------+------------+-----------+\r\n</pre>\r\n\r\n<p><b>Note:</b><br />\r\nEach day only have one row record, and the dates are increasing with id increasing.</p>\r\n",
  "isPaidOnly": false,
  "difficulty": "Hard",
  "likes": 123,
  "dislikes": 261,
  "isLiked": null,
  "similarQuestions": "[]",
  "contributors": [
    {
      "username": "Douglas1612",
      "profileUrl": "/douglas1612/",
      "avatarUrl": "https://www.gravatar.com/avatar/8e60a4b596b7a8ba118c776bac2a0b04.png?s=200"
    }
  ],
  "topicTags": [],
  "companyTagStats": "{\"1\": [{\"taggedByAdmin\": false, \"name\": \"Adobe\", \"slug\": \"adobe\", \"timesEncountered\": 2}], \"2\": [], \"3\": []}",
  "codeSnippets": [
    {
      "lang": "MySQL",
      "code": "# Write your MySQL query statement below\n"
    },
    {
      "lang": "MS SQL Server",
      "code": "/* Write your T-SQL query statement below */\n"
    },
    {
      "lang": "Oracle",
      "code": "/* Write your PL/SQL query statement below */\n"
    }
  ],
  "stats": "{\"totalAccepted\": \"20.3K\", \"totalSubmission\": \"52.2K\", \"totalAcceptedRaw\": 20341, \"totalSubmissionRaw\": 52218, \"acRate\": \"39.0%\"}",
  "hints": [],
  "solution": {
    "id": "203",
    "canSeeDetail": true,
    "url": "/articles/human-traffic-of-stadium/",
    "content": "[TOC]\n\n## Solution\n---\n#### Approach: Using `JOIN` and `WHERE` clause [Accepted]\n\n**Intuition**\n\nSelect the days with more than 100 people attending the stadium, and join this temp table with itself. We might get the solution after using complex conditions in a `WHERE` clause.\n\n**Algorithm**\n\nThe first step is to get the days with 100 people and join this table with itself.\n```sql\nselect distinct t1.*\nfrom stadium t1, stadium t2, stadium t3\nwhere t1.people >= 100 and t2.people >= 100 and t3.people >= 100\n;\n```\n\n| id | date       | people | id | date       | people | id | date       | people |\n|----|------------|--------|----|------------|--------|----|------------|--------|\n| 2  | 2017-01-02 | 109    | 2  | 2017-01-02 | 109    | 2  | 2017-01-02 | 109    |\n| 3  | 2017-01-03 | 150    | 2  | 2017-01-02 | 109    | 2  | 2017-01-02 | 109    |\n| 5  | 2017-01-05 | 145    | 2  | 2017-01-02 | 109    | 2  | 2017-01-02 | 109    |\n| 6  | 2017-01-06 | 1455   | 2  | 2017-01-02 | 109    | 2  | 2017-01-02 | 109    |\n| 7  | 2017-01-07 | 199    | 2  | 2017-01-02 | 109    | 2  | 2017-01-02 | 109    |\n| 8  | 2017-01-08 | 188    | 2  | 2017-01-02 | 109    | 2  | 2017-01-02 | 109    |\n| 2  | 2017-01-02 | 109    | 3  | 2017-01-03 | 150    | 2  | 2017-01-02 | 109    |\n| 3  | 2017-01-03 | 150    | 3  | 2017-01-03 | 150    | 2  | 2017-01-02 | 109    |\n| 5  | 2017-01-05 | 145    | 3  | 2017-01-03 | 150    | 2  | 2017-01-02 | 109    |\n| 6  | 2017-01-06 | 1455   | 3  | 2017-01-03 | 150    | 2  | 2017-01-02 | 109    |\n| 7  | 2017-01-07 | 199    | 3  | 2017-01-03 | 150    | 2  | 2017-01-02 | 109    |\n| 8  | 2017-01-08 | 188    | 3  | 2017-01-03 | 150    | 2  | 2017-01-02 | 109    |\n| 2  | 2017-01-02 | 109    | 5  | 2017-01-05 | 145    | 2  | 2017-01-02 | 109    |\n| 3  | 2017-01-03 | 150    | 5  | 2017-01-05 | 145    | 2  | 2017-01-02 | 109    |\n| 5  | 2017-01-05 | 145    | 5  | 2017-01-05 | 145    | 2  | 2017-01-02 | 109    |\n| 6  | 2017-01-06 | 1455   | 5  | 2017-01-05 | 145    | 2  | 2017-01-02 | 109    |\n| 7  | 2017-01-07 | 199    | 5  | 2017-01-05 | 145    | 2  | 2017-01-02 | 109    |\n| 8  | 2017-01-08 | 188    | 5  | 2017-01-05 | 145    | 2  | 2017-01-02 | 109    |\n| 2  | 2017-01-02 | 109    | 6  | 2017-01-06 | 1455   | 2  | 2017-01-02 | 109    |\n| 3  | 2017-01-03 | 150    | 6  | 2017-01-06 | 1455   | 2  | 2017-01-02 | 109    |\n| 5  | 2017-01-05 | 145    | 6  | 2017-01-06 | 1455   | 2  | 2017-01-02 | 109    |\n| 6  | 2017-01-06 | 1455   | 6  | 2017-01-06 | 1455   | 2  | 2017-01-02 | 109    |\n| 7  | 2017-01-07 | 199    | 6  | 2017-01-06 | 1455   | 2  | 2017-01-02 | 109    |\n| 8  | 2017-01-08 | 188    | 6  | 2017-01-06 | 1455   | 2  | 2017-01-02 | 109    |\n| 2  | 2017-01-02 | 109    | 7  | 2017-01-07 | 199    | 2  | 2017-01-02 | 109    |\n| 3  | 2017-01-03 | 150    | 7  | 2017-01-07 | 199    | 2  | 2017-01-02 | 109    |\n| 5  | 2017-01-05 | 145    | 7  | 2017-01-07 | 199    | 2  | 2017-01-02 | 109    |\n| 6  | 2017-01-06 | 1455   | 7  | 2017-01-07 | 199    | 2  | 2017-01-02 | 109    |\n| 7  | 2017-01-07 | 199    | 7  | 2017-01-07 | 199    | 2  | 2017-01-02 | 109    |\n| 8  | 2017-01-08 | 188    | 7  | 2017-01-07 | 199    | 2  | 2017-01-02 | 109    |\n| 2  | 2017-01-02 | 109    | 8  | 2017-01-08 | 188    | 2  | 2017-01-02 | 109    |\n| 3  | 2017-01-03 | 150    | 8  | 2017-01-08 | 188    | 2  | 2017-01-02 | 109    |\n| 5  | 2017-01-05 | 145    | 8  | 2017-01-08 | 188    | 2  | 2017-01-02 | 109    |\n| 6  | 2017-01-06 | 1455   | 8  | 2017-01-08 | 188    | 2  | 2017-01-02 | 109    |\n| 7  | 2017-01-07 | 199    | 8  | 2017-01-08 | 188    | 2  | 2017-01-02 | 109    |\n| 8  | 2017-01-08 | 188    | 8  | 2017-01-08 | 188    | 2  | 2017-01-02 | 109    |\n| 2  | 2017-01-02 | 109    | 2  | 2017-01-02 | 109    | 3  | 2017-01-03 | 150    |\n| 3  | 2017-01-03 | 150    | 2  | 2017-01-02 | 109    | 3  | 2017-01-03 | 150    |\n| 5  | 2017-01-05 | 145    | 2  | 2017-01-02 | 109    | 3  | 2017-01-03 | 150    |\n| 6  | 2017-01-06 | 1455   | 2  | 2017-01-02 | 109    | 3  | 2017-01-03 | 150    |\n| 7  | 2017-01-07 | 199    | 2  | 2017-01-02 | 109    | 3  | 2017-01-03 | 150    |\n| 8  | 2017-01-08 | 188    | 2  | 2017-01-02 | 109    | 3  | 2017-01-03 | 150    |\n| 2  | 2017-01-02 | 109    | 3  | 2017-01-03 | 150    | 3  | 2017-01-03 | 150    |\n| 3  | 2017-01-03 | 150    | 3  | 2017-01-03 | 150    | 3  | 2017-01-03 | 150    |\n| 5  | 2017-01-05 | 145    | 3  | 2017-01-03 | 150    | 3  | 2017-01-03 | 150    |\n| 6  | 2017-01-06 | 1455   | 3  | 2017-01-03 | 150    | 3  | 2017-01-03 | 150    |\n| 7  | 2017-01-07 | 199    | 3  | 2017-01-03 | 150    | 3  | 2017-01-03 | 150    |\n| 8  | 2017-01-08 | 188    | 3  | 2017-01-03 | 150    | 3  | 2017-01-03 | 150    |\n| 2  | 2017-01-02 | 109    | 5  | 2017-01-05 | 145    | 3  | 2017-01-03 | 150    |\n| 3  | 2017-01-03 | 150    | 5  | 2017-01-05 | 145    | 3  | 2017-01-03 | 150    |\n| 5  | 2017-01-05 | 145    | 5  | 2017-01-05 | 145    | 3  | 2017-01-03 | 150    |\n| 6  | 2017-01-06 | 1455   | 5  | 2017-01-05 | 145    | 3  | 2017-01-03 | 150    |\n| 7  | 2017-01-07 | 199    | 5  | 2017-01-05 | 145    | 3  | 2017-01-03 | 150    |\n| 8  | 2017-01-08 | 188    | 5  | 2017-01-05 | 145    | 3  | 2017-01-03 | 150    |\n| 2  | 2017-01-02 | 109    | 6  | 2017-01-06 | 1455   | 3  | 2017-01-03 | 150    |\n| 3  | 2017-01-03 | 150    | 6  | 2017-01-06 | 1455   | 3  | 2017-01-03 | 150    |\n| 5  | 2017-01-05 | 145    | 6  | 2017-01-06 | 1455   | 3  | 2017-01-03 | 150    |\n| 6  | 2017-01-06 | 1455   | 6  | 2017-01-06 | 1455   | 3  | 2017-01-03 | 150    |\n| 7  | 2017-01-07 | 199    | 6  | 2017-01-06 | 1455   | 3  | 2017-01-03 | 150    |\n| 8  | 2017-01-08 | 188    | 6  | 2017-01-06 | 1455   | 3  | 2017-01-03 | 150    |\n| 2  | 2017-01-02 | 109    | 7  | 2017-01-07 | 199    | 3  | 2017-01-03 | 150    |\n| 3  | 2017-01-03 | 150    | 7  | 2017-01-07 | 199    | 3  | 2017-01-03 | 150    |\n| 5  | 2017-01-05 | 145    | 7  | 2017-01-07 | 199    | 3  | 2017-01-03 | 150    |\n| 6  | 2017-01-06 | 1455   | 7  | 2017-01-07 | 199    | 3  | 2017-01-03 | 150    |\n| 7  | 2017-01-07 | 199    | 7  | 2017-01-07 | 199    | 3  | 2017-01-03 | 150    |\n| 8  | 2017-01-08 | 188    | 7  | 2017-01-07 | 199    | 3  | 2017-01-03 | 150    |\n| 2  | 2017-01-02 | 109    | 8  | 2017-01-08 | 188    | 3  | 2017-01-03 | 150    |\n| 3  | 2017-01-03 | 150    | 8  | 2017-01-08 | 188    | 3  | 2017-01-03 | 150    |\n| 5  | 2017-01-05 | 145    | 8  | 2017-01-08 | 188    | 3  | 2017-01-03 | 150    |\n| 6  | 2017-01-06 | 1455   | 8  | 2017-01-08 | 188    | 3  | 2017-01-03 | 150    |\n| 7  | 2017-01-07 | 199    | 8  | 2017-01-08 | 188    | 3  | 2017-01-03 | 150    |\n| 8  | 2017-01-08 | 188    | 8  | 2017-01-08 | 188    | 3  | 2017-01-03 | 150    |\n| 2  | 2017-01-02 | 109    | 2  | 2017-01-02 | 109    | 5  | 2017-01-05 | 145    |\n| 3  | 2017-01-03 | 150    | 2  | 2017-01-02 | 109    | 5  | 2017-01-05 | 145    |\n| 5  | 2017-01-05 | 145    | 2  | 2017-01-02 | 109    | 5  | 2017-01-05 | 145    |\n| 6  | 2017-01-06 | 1455   | 2  | 2017-01-02 | 109    | 5  | 2017-01-05 | 145    |\n| 7  | 2017-01-07 | 199    | 2  | 2017-01-02 | 109    | 5  | 2017-01-05 | 145    |\n| 8  | 2017-01-08 | 188    | 2  | 2017-01-02 | 109    | 5  | 2017-01-05 | 145    |\n| 2  | 2017-01-02 | 109    | 3  | 2017-01-03 | 150    | 5  | 2017-01-05 | 145    |\n| 3  | 2017-01-03 | 150    | 3  | 2017-01-03 | 150    | 5  | 2017-01-05 | 145    |\n| 5  | 2017-01-05 | 145    | 3  | 2017-01-03 | 150    | 5  | 2017-01-05 | 145    |\n| 6  | 2017-01-06 | 1455   | 3  | 2017-01-03 | 150    | 5  | 2017-01-05 | 145    |\n| 7  | 2017-01-07 | 199    | 3  | 2017-01-03 | 150    | 5  | 2017-01-05 | 145    |\n| 8  | 2017-01-08 | 188    | 3  | 2017-01-03 | 150    | 5  | 2017-01-05 | 145    |\n| 2  | 2017-01-02 | 109    | 5  | 2017-01-05 | 145    | 5  | 2017-01-05 | 145    |\n| 3  | 2017-01-03 | 150    | 5  | 2017-01-05 | 145    | 5  | 2017-01-05 | 145    |\n| 5  | 2017-01-05 | 145    | 5  | 2017-01-05 | 145    | 5  | 2017-01-05 | 145    |\n| 6  | 2017-01-06 | 1455   | 5  | 2017-01-05 | 145    | 5  | 2017-01-05 | 145    |\n| 7  | 2017-01-07 | 199    | 5  | 2017-01-05 | 145    | 5  | 2017-01-05 | 145    |\n| 8  | 2017-01-08 | 188    | 5  | 2017-01-05 | 145    | 5  | 2017-01-05 | 145    |\n| 2  | 2017-01-02 | 109    | 6  | 2017-01-06 | 1455   | 5  | 2017-01-05 | 145    |\n| 3  | 2017-01-03 | 150    | 6  | 2017-01-06 | 1455   | 5  | 2017-01-05 | 145    |\n| 5  | 2017-01-05 | 145    | 6  | 2017-01-06 | 1455   | 5  | 2017-01-05 | 145    |\n| 6  | 2017-01-06 | 1455   | 6  | 2017-01-06 | 1455   | 5  | 2017-01-05 | 145    |\n| 7  | 2017-01-07 | 199    | 6  | 2017-01-06 | 1455   | 5  | 2017-01-05 | 145    |\n| 8  | 2017-01-08 | 188    | 6  | 2017-01-06 | 1455   | 5  | 2017-01-05 | 145    |\n| 2  | 2017-01-02 | 109    | 7  | 2017-01-07 | 199    | 5  | 2017-01-05 | 145    |\n| 3  | 2017-01-03 | 150    | 7  | 2017-01-07 | 199    | 5  | 2017-01-05 | 145    |\n| 5  | 2017-01-05 | 145    | 7  | 2017-01-07 | 199    | 5  | 2017-01-05 | 145    |\n| 6  | 2017-01-06 | 1455   | 7  | 2017-01-07 | 199    | 5  | 2017-01-05 | 145    |\n| 7  | 2017-01-07 | 199    | 7  | 2017-01-07 | 199    | 5  | 2017-01-05 | 145    |\n| 8  | 2017-01-08 | 188    | 7  | 2017-01-07 | 199    | 5  | 2017-01-05 | 145    |\n| 2  | 2017-01-02 | 109    | 8  | 2017-01-08 | 188    | 5  | 2017-01-05 | 145    |\n| 3  | 2017-01-03 | 150    | 8  | 2017-01-08 | 188    | 5  | 2017-01-05 | 145    |\n| 5  | 2017-01-05 | 145    | 8  | 2017-01-08 | 188    | 5  | 2017-01-05 | 145    |\n| 6  | 2017-01-06 | 1455   | 8  | 2017-01-08 | 188    | 5  | 2017-01-05 | 145    |\n| 7  | 2017-01-07 | 199    | 8  | 2017-01-08 | 188    | 5  | 2017-01-05 | 145    |\n| 8  | 2017-01-08 | 188    | 8  | 2017-01-08 | 188    | 5  | 2017-01-05 | 145    |\n| 2  | 2017-01-02 | 109    | 2  | 2017-01-02 | 109    | 6  | 2017-01-06 | 1455   |\n| 3  | 2017-01-03 | 150    | 2  | 2017-01-02 | 109    | 6  | 2017-01-06 | 1455   |\n| 5  | 2017-01-05 | 145    | 2  | 2017-01-02 | 109    | 6  | 2017-01-06 | 1455   |\n| 6  | 2017-01-06 | 1455   | 2  | 2017-01-02 | 109    | 6  | 2017-01-06 | 1455   |\n| 7  | 2017-01-07 | 199    | 2  | 2017-01-02 | 109    | 6  | 2017-01-06 | 1455   |\n| 8  | 2017-01-08 | 188    | 2  | 2017-01-02 | 109    | 6  | 2017-01-06 | 1455   |\n| 2  | 2017-01-02 | 109    | 3  | 2017-01-03 | 150    | 6  | 2017-01-06 | 1455   |\n| 3  | 2017-01-03 | 150    | 3  | 2017-01-03 | 150    | 6  | 2017-01-06 | 1455   |\n| 5  | 2017-01-05 | 145    | 3  | 2017-01-03 | 150    | 6  | 2017-01-06 | 1455   |\n| 6  | 2017-01-06 | 1455   | 3  | 2017-01-03 | 150    | 6  | 2017-01-06 | 1455   |\n| 7  | 2017-01-07 | 199    | 3  | 2017-01-03 | 150    | 6  | 2017-01-06 | 1455   |\n| 8  | 2017-01-08 | 188    | 3  | 2017-01-03 | 150    | 6  | 2017-01-06 | 1455   |\n| 2  | 2017-01-02 | 109    | 5  | 2017-01-05 | 145    | 6  | 2017-01-06 | 1455   |\n| 3  | 2017-01-03 | 150    | 5  | 2017-01-05 | 145    | 6  | 2017-01-06 | 1455   |\n| 5  | 2017-01-05 | 145    | 5  | 2017-01-05 | 145    | 6  | 2017-01-06 | 1455   |\n| 6  | 2017-01-06 | 1455   | 5  | 2017-01-05 | 145    | 6  | 2017-01-06 | 1455   |\n| 7  | 2017-01-07 | 199    | 5  | 2017-01-05 | 145    | 6  | 2017-01-06 | 1455   |\n| 8  | 2017-01-08 | 188    | 5  | 2017-01-05 | 145    | 6  | 2017-01-06 | 1455   |\n| 2  | 2017-01-02 | 109    | 6  | 2017-01-06 | 1455   | 6  | 2017-01-06 | 1455   |\n| 3  | 2017-01-03 | 150    | 6  | 2017-01-06 | 1455   | 6  | 2017-01-06 | 1455   |\n| 5  | 2017-01-05 | 145    | 6  | 2017-01-06 | 1455   | 6  | 2017-01-06 | 1455   |\n| 6  | 2017-01-06 | 1455   | 6  | 2017-01-06 | 1455   | 6  | 2017-01-06 | 1455   |\n| 7  | 2017-01-07 | 199    | 6  | 2017-01-06 | 1455   | 6  | 2017-01-06 | 1455   |\n| 8  | 2017-01-08 | 188    | 6  | 2017-01-06 | 1455   | 6  | 2017-01-06 | 1455   |\n| 2  | 2017-01-02 | 109    | 7  | 2017-01-07 | 199    | 6  | 2017-01-06 | 1455   |\n| 3  | 2017-01-03 | 150    | 7  | 2017-01-07 | 199    | 6  | 2017-01-06 | 1455   |\n| 5  | 2017-01-05 | 145    | 7  | 2017-01-07 | 199    | 6  | 2017-01-06 | 1455   |\n| 6  | 2017-01-06 | 1455   | 7  | 2017-01-07 | 199    | 6  | 2017-01-06 | 1455   |\n| 7  | 2017-01-07 | 199    | 7  | 2017-01-07 | 199    | 6  | 2017-01-06 | 1455   |\n| 8  | 2017-01-08 | 188    | 7  | 2017-01-07 | 199    | 6  | 2017-01-06 | 1455   |\n| 2  | 2017-01-02 | 109    | 8  | 2017-01-08 | 188    | 6  | 2017-01-06 | 1455   |\n| 3  | 2017-01-03 | 150    | 8  | 2017-01-08 | 188    | 6  | 2017-01-06 | 1455   |\n| 5  | 2017-01-05 | 145    | 8  | 2017-01-08 | 188    | 6  | 2017-01-06 | 1455   |\n| 6  | 2017-01-06 | 1455   | 8  | 2017-01-08 | 188    | 6  | 2017-01-06 | 1455   |\n| 7  | 2017-01-07 | 199    | 8  | 2017-01-08 | 188    | 6  | 2017-01-06 | 1455   |\n| 8  | 2017-01-08 | 188    | 8  | 2017-01-08 | 188    | 6  | 2017-01-06 | 1455   |\n| 2  | 2017-01-02 | 109    | 2  | 2017-01-02 | 109    | 7  | 2017-01-07 | 199    |\n| 3  | 2017-01-03 | 150    | 2  | 2017-01-02 | 109    | 7  | 2017-01-07 | 199    |\n| 5  | 2017-01-05 | 145    | 2  | 2017-01-02 | 109    | 7  | 2017-01-07 | 199    |\n| 6  | 2017-01-06 | 1455   | 2  | 2017-01-02 | 109    | 7  | 2017-01-07 | 199    |\n| 7  | 2017-01-07 | 199    | 2  | 2017-01-02 | 109    | 7  | 2017-01-07 | 199    |\n| 8  | 2017-01-08 | 188    | 2  | 2017-01-02 | 109    | 7  | 2017-01-07 | 199    |\n| 2  | 2017-01-02 | 109    | 3  | 2017-01-03 | 150    | 7  | 2017-01-07 | 199    |\n| 3  | 2017-01-03 | 150    | 3  | 2017-01-03 | 150    | 7  | 2017-01-07 | 199    |\n| 5  | 2017-01-05 | 145    | 3  | 2017-01-03 | 150    | 7  | 2017-01-07 | 199    |\n| 6  | 2017-01-06 | 1455   | 3  | 2017-01-03 | 150    | 7  | 2017-01-07 | 199    |\n| 7  | 2017-01-07 | 199    | 3  | 2017-01-03 | 150    | 7  | 2017-01-07 | 199    |\n| 8  | 2017-01-08 | 188    | 3  | 2017-01-03 | 150    | 7  | 2017-01-07 | 199    |\n| 2  | 2017-01-02 | 109    | 5  | 2017-01-05 | 145    | 7  | 2017-01-07 | 199    |\n| 3  | 2017-01-03 | 150    | 5  | 2017-01-05 | 145    | 7  | 2017-01-07 | 199    |\n| 5  | 2017-01-05 | 145    | 5  | 2017-01-05 | 145    | 7  | 2017-01-07 | 199    |\n| 6  | 2017-01-06 | 1455   | 5  | 2017-01-05 | 145    | 7  | 2017-01-07 | 199    |\n| 7  | 2017-01-07 | 199    | 5  | 2017-01-05 | 145    | 7  | 2017-01-07 | 199    |\n| 8  | 2017-01-08 | 188    | 5  | 2017-01-05 | 145    | 7  | 2017-01-07 | 199    |\n| 2  | 2017-01-02 | 109    | 6  | 2017-01-06 | 1455   | 7  | 2017-01-07 | 199    |\n| 3  | 2017-01-03 | 150    | 6  | 2017-01-06 | 1455   | 7  | 2017-01-07 | 199    |\n| 5  | 2017-01-05 | 145    | 6  | 2017-01-06 | 1455   | 7  | 2017-01-07 | 199    |\n| 6  | 2017-01-06 | 1455   | 6  | 2017-01-06 | 1455   | 7  | 2017-01-07 | 199    |\n| 7  | 2017-01-07 | 199    | 6  | 2017-01-06 | 1455   | 7  | 2017-01-07 | 199    |\n| 8  | 2017-01-08 | 188    | 6  | 2017-01-06 | 1455   | 7  | 2017-01-07 | 199    |\n| 2  | 2017-01-02 | 109    | 7  | 2017-01-07 | 199    | 7  | 2017-01-07 | 199    |\n| 3  | 2017-01-03 | 150    | 7  | 2017-01-07 | 199    | 7  | 2017-01-07 | 199    |\n| 5  | 2017-01-05 | 145    | 7  | 2017-01-07 | 199    | 7  | 2017-01-07 | 199    |\n| 6  | 2017-01-06 | 1455   | 7  | 2017-01-07 | 199    | 7  | 2017-01-07 | 199    |\n| 7  | 2017-01-07 | 199    | 7  | 2017-01-07 | 199    | 7  | 2017-01-07 | 199    |\n| 8  | 2017-01-08 | 188    | 7  | 2017-01-07 | 199    | 7  | 2017-01-07 | 199    |\n| 2  | 2017-01-02 | 109    | 8  | 2017-01-08 | 188    | 7  | 2017-01-07 | 199    |\n| 3  | 2017-01-03 | 150    | 8  | 2017-01-08 | 188    | 7  | 2017-01-07 | 199    |\n| 5  | 2017-01-05 | 145    | 8  | 2017-01-08 | 188    | 7  | 2017-01-07 | 199    |\n| 6  | 2017-01-06 | 1455   | 8  | 2017-01-08 | 188    | 7  | 2017-01-07 | 199    |\n| 7  | 2017-01-07 | 199    | 8  | 2017-01-08 | 188    | 7  | 2017-01-07 | 199    |\n| 8  | 2017-01-08 | 188    | 8  | 2017-01-08 | 188    | 7  | 2017-01-07 | 199    |\n| 2  | 2017-01-02 | 109    | 2  | 2017-01-02 | 109    | 8  | 2017-01-08 | 188    |\n| 3  | 2017-01-03 | 150    | 2  | 2017-01-02 | 109    | 8  | 2017-01-08 | 188    |\n| 5  | 2017-01-05 | 145    | 2  | 2017-01-02 | 109    | 8  | 2017-01-08 | 188    |\n| 6  | 2017-01-06 | 1455   | 2  | 2017-01-02 | 109    | 8  | 2017-01-08 | 188    |\n| 7  | 2017-01-07 | 199    | 2  | 2017-01-02 | 109    | 8  | 2017-01-08 | 188    |\n| 8  | 2017-01-08 | 188    | 2  | 2017-01-02 | 109    | 8  | 2017-01-08 | 188    |\n| 2  | 2017-01-02 | 109    | 3  | 2017-01-03 | 150    | 8  | 2017-01-08 | 188    |\n| 3  | 2017-01-03 | 150    | 3  | 2017-01-03 | 150    | 8  | 2017-01-08 | 188    |\n| 5  | 2017-01-05 | 145    | 3  | 2017-01-03 | 150    | 8  | 2017-01-08 | 188    |\n| 6  | 2017-01-06 | 1455   | 3  | 2017-01-03 | 150    | 8  | 2017-01-08 | 188    |\n| 7  | 2017-01-07 | 199    | 3  | 2017-01-03 | 150    | 8  | 2017-01-08 | 188    |\n| 8  | 2017-01-08 | 188    | 3  | 2017-01-03 | 150    | 8  | 2017-01-08 | 188    |\n| 2  | 2017-01-02 | 109    | 5  | 2017-01-05 | 145    | 8  | 2017-01-08 | 188    |\n| 3  | 2017-01-03 | 150    | 5  | 2017-01-05 | 145    | 8  | 2017-01-08 | 188    |\n| 5  | 2017-01-05 | 145    | 5  | 2017-01-05 | 145    | 8  | 2017-01-08 | 188    |\n| 6  | 2017-01-06 | 1455   | 5  | 2017-01-05 | 145    | 8  | 2017-01-08 | 188    |\n| 7  | 2017-01-07 | 199    | 5  | 2017-01-05 | 145    | 8  | 2017-01-08 | 188    |\n| 8  | 2017-01-08 | 188    | 5  | 2017-01-05 | 145    | 8  | 2017-01-08 | 188    |\n| 2  | 2017-01-02 | 109    | 6  | 2017-01-06 | 1455   | 8  | 2017-01-08 | 188    |\n| 3  | 2017-01-03 | 150    | 6  | 2017-01-06 | 1455   | 8  | 2017-01-08 | 188    |\n| 5  | 2017-01-05 | 145    | 6  | 2017-01-06 | 1455   | 8  | 2017-01-08 | 188    |\n| 6  | 2017-01-06 | 1455   | 6  | 2017-01-06 | 1455   | 8  | 2017-01-08 | 188    |\n| 7  | 2017-01-07 | 199    | 6  | 2017-01-06 | 1455   | 8  | 2017-01-08 | 188    |\n| 8  | 2017-01-08 | 188    | 6  | 2017-01-06 | 1455   | 8  | 2017-01-08 | 188    |\n| 2  | 2017-01-02 | 109    | 7  | 2017-01-07 | 199    | 8  | 2017-01-08 | 188    |\n| 3  | 2017-01-03 | 150    | 7  | 2017-01-07 | 199    | 8  | 2017-01-08 | 188    |\n| 5  | 2017-01-05 | 145    | 7  | 2017-01-07 | 199    | 8  | 2017-01-08 | 188    |\n| 6  | 2017-01-06 | 1455   | 7  | 2017-01-07 | 199    | 8  | 2017-01-08 | 188    |\n| 7  | 2017-01-07 | 199    | 7  | 2017-01-07 | 199    | 8  | 2017-01-08 | 188    |\n| 8  | 2017-01-08 | 188    | 7  | 2017-01-07 | 199    | 8  | 2017-01-08 | 188    |\n| 2  | 2017-01-02 | 109    | 8  | 2017-01-08 | 188    | 8  | 2017-01-08 | 188    |\n| 3  | 2017-01-03 | 150    | 8  | 2017-01-08 | 188    | 8  | 2017-01-08 | 188    |\n| 5  | 2017-01-05 | 145    | 8  | 2017-01-08 | 188    | 8  | 2017-01-08 | 188    |\n| 6  | 2017-01-06 | 1455   | 8  | 2017-01-08 | 188    | 8  | 2017-01-08 | 188    |\n| 7  | 2017-01-07 | 199    | 8  | 2017-01-08 | 188    | 8  | 2017-01-08 | 188    |\n| 8  | 2017-01-08 | 188    | 8  | 2017-01-08 | 188    | 8  | 2017-01-08 | 188    |\n\n>Note:\n> - There are 6 days with more than 100 people. So there are 216(6*6*6) records in total after  [Cartesian product](https://en.wikipedia.org/wiki/Cartesian_product).\n> - The first 3 columns are from t1, and the next 3 ones are from t2, and the last 3 are from t3.\n\n\nConsidering t1, t2 and t3 are identical, we can take one of them to consider what conditions we should add to filter the data and get the final result. Taking t1 for example, it could exist in the beginning of the consecutive 3 days, or the middle, or the last.\n\n- t1 in the beginning: `(t1.id - t2.id = 1 and t1.id - t3.id = 2 and t2.id - t3.id =1)  -- t1, t2, t3`\n- t1 in the middle: `(t2.id - t1.id = 1 and t2.id - t3.id = 2 and t1.id - t3.id =1) -- t2, t1, t3`\n- t1 in the end: `(t3.id - t2.id = 1 and t2.id - t1.id =1 and t3.id - t1.id = 2) -- t3, t2, t1`\n\nSo if we add these conditions in the SQL code, we can get this.\n```sql\nselect t1.*\nfrom stadium t1, stadium t2, stadium t3\nwhere t1.people >= 100 and t2.people >= 100 and t3.people >= 100\nand\n(\n\t  (t1.id - t2.id = 1 and t1.id - t3.id = 2 and t2.id - t3.id =1)  -- t1, t2, t3\n    or\n    (t2.id - t1.id = 1 and t2.id - t3.id = 2 and t1.id - t3.id =1) -- t2, t1, t3\n    or\n    (t3.id - t2.id = 1 and t2.id - t1.id =1 and t3.id - t1.id = 2) -- t3, t2, t1\n)\n;\n```\n\n```\n| id | date       | people |\n|----|------------|--------|\n| 7  | 2017-01-07 | 199    |\n| 6  | 2017-01-06 | 1455   |\n| 8  | 2017-01-08 | 188    |\n| 7  | 2017-01-07 | 199    |\n| 5  | 2017-01-05 | 145    |\n| 6  | 2017-01-06 | 1455   |\n```\n\nYou may notice some records duplicates since they appear in different positions. So, we can use `DISTINCT` to deal with it.\n\n**MySQL**\n\n```sql\nselect distinct t1.*\nfrom stadium t1, stadium t2, stadium t3\nwhere t1.people >= 100 and t2.people >= 100 and t3.people >= 100\nand\n(\n\t  (t1.id - t2.id = 1 and t1.id - t3.id = 2 and t2.id - t3.id =1)  -- t1, t2, t3\n    or\n    (t2.id - t1.id = 1 and t2.id - t3.id = 2 and t1.id - t3.id =1) -- t2, t1, t3\n    or\n    (t3.id - t2.id = 1 and t2.id - t1.id =1 and t3.id - t1.id = 2) -- t3, t2, t1\n)\norder by t1.id\n;\n```",
    "contentTypeId": "107",
    "rating": {
      "id": "198",
      "count": 12,
      "average": 4.5,
      "userRating": null
    }
  },
  "status": null,
  "sampleTestCase": "{\"headers\": {\"stadium\": [\"id\", \"visit_date\", \"people\"]}, \"rows\": {\"stadium\": [[1, \"2017-01-01\", 10], [2, \"2017-01-02\", 109], [3, \"2017-01-03\", 150], [4, \"2017-01-04\", 99], [5, \"2017-01-05\", 145], [6, \"2017-01-06\", 1455], [7, \"2017-01-07\", 199], [8, \"2017-01-08\", 188]]}}",
  "metaData": "{\r\n  \"mysql\": [\r\n    \"Create table If Not Exists stadium (id int, visit_date DATE NULL, people int)\"\r\n  ],\r\n  \"mssql\": [\r\n    \"Create table stadium (id int, visit_date DATE NULL, people int)\"\r\n  ],\r\n  \"oraclesql\": [\r\n    \"Create table stadium (id int, visit_date DATE, people int)\",\r\n    \"ALTER SESSION SET nls_date_format='YYYY-MM-DD'\"\r\n  ],\r\n  \"database\": true\r\n}",
  "judgerAvailable": true,
  "judgeType": "large",
  "mysqlSchemas": [
    "Create table If Not Exists stadium (id int, visit_date DATE NULL, people int)",
    "Truncate table stadium",
    "insert into stadium (id, visit_date, people) values ('1', '2017-01-01', '10')",
    "insert into stadium (id, visit_date, people) values ('2', '2017-01-02', '109')",
    "insert into stadium (id, visit_date, people) values ('3', '2017-01-03', '150')",
    "insert into stadium (id, visit_date, people) values ('4', '2017-01-04', '99')",
    "insert into stadium (id, visit_date, people) values ('5', '2017-01-05', '145')",
    "insert into stadium (id, visit_date, people) values ('6', '2017-01-06', '1455')",
    "insert into stadium (id, visit_date, people) values ('7', '2017-01-07', '199')",
    "insert into stadium (id, visit_date, people) values ('8', '2017-01-08', '188')"
  ],
  "enableRunCode": true,
  "enableTestMode": false,
  "libraryUrl": null
}
